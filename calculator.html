<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Calculator</title>
    <style>
      :root {
        --bg: #0f172a;
        --panel: #111827;
        --panel-2: #0b1220;
        --text: #e5e7eb;
        --muted: #9ca3af;
        --accent: #22c55e;
        --danger: #ef4444;
        --border: #1f2937;
      }
      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        background: radial-gradient(1200px 800px at 80% -10%, rgba(34,197,94,0.15), transparent 60%),
                    radial-gradient(1000px 900px at -10% 120%, rgba(59,130,246,0.15), transparent 60%),
                    var(--bg);
        color: var(--text);
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
        display: grid;
        place-items: center;
        padding: 24px 12px;
      }
      .shell {
        width: min(420px, 92vw);
        background: color-mix(in srgb, var(--panel) 92%, black 8%);
        border: 1px solid var(--border);
        border-radius: 18px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.45);
        overflow: hidden;
      }
      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 14px;
        border-bottom: 1px solid var(--border);
        background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0));
      }
      .title { font-weight: 600; letter-spacing: 0.2px; }
      .screen {
        padding: 18px;
        display: grid;
        gap: 10px;
        background: var(--panel-2);
        border-bottom: 1px solid var(--border);
      }
      .expr {
        min-height: 32px;
        color: var(--muted);
        text-align: right;
        word-wrap: break-word;
        word-break: break-all;
      }
      .result {
        font-size: clamp(24px, 4.8vw, 40px);
        text-align: right;
        line-height: 1.2;
      }
      .keys {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 8px;
        padding: 14px;
      }
      button {
        appearance: none;
        border: 1px solid #223049;
        background: #0e1626;
        color: var(--text);
        border-radius: 14px;
        padding: 14px 10px;
        font-size: 18px;
        cursor: pointer;
        transition: transform 120ms ease, filter 120ms ease, background 120ms ease;
      }
      button:hover { filter: brightness(1.08); }
      button:active { transform: translateY(1px); }
      .op { background: #101b32; border-color: #2a3a5a; color: #bfdbfe; }
      .accent { background: #0f2918; border-color: #1c6b3e; color: #86efac; }
      .danger { background: #2a0f13; border-color: #7f1d1d; color: #fecaca; }
      .wide { grid-column: span 2; }
      .footer { padding: 10px 14px; color: var(--muted); font-size: 12px; text-align: center; border-top: 1px solid var(--border); }

      @media (max-width: 380px) {
        .keys { gap: 6px; }
        button { padding: 12px 8px; font-size: 16px; }
      }
    </style>
  </head>
  <body>
    <div class="shell" role="application" aria-label="Calculator">
      <div class="header">
        <div class="title">Modern Calculator</div>
        <div style="display:flex; gap:8px; align-items:center; opacity:.9">
          <span style="width:8px;height:8px;background:#ef4444;border-radius:50%"></span>
          <span style="width:8px;height:8px;background:#f59e0b;border-radius:50%"></span>
          <span style="width:8px;height:8px;background:#22c55e;border-radius:50%"></span>
        </div>
      </div>
      <div class="screen">
        <div id="expr" class="expr" aria-live="polite"></div>
        <div id="res" class="result" aria-live="polite">0</div>
      </div>
      <div class="keys">
        <button class="danger" data-act="clear" aria-label="Clear">C</button>
        <button class="op" data-val="(">(</button>
        <button class="op" data-val=")">)</button>
        <button class="op" data-val="/">÷</button>

        <button data-val="7">7</button>
        <button data-val="8">8</button>
        <button data-val="9">9</button>
        <button class="op" data-val="*">×</button>

        <button data-val="4">4</button>
        <button data-val="5">5</button>
        <button data-val="6">6</button>
        <button class="op" data-val="-">−</button>

        <button data-val="1">1</button>
        <button data-val="2">2</button>
        <button data-val="3">3</button>
        <button class="op" data-val="+">+</button>

        <button class="wide" data-act="back" aria-label="Backspace">⌫</button>
        <button data-val="0">0</button>
        <button data-val=".">.</button>
        <button class="accent" data-act="equals" aria-label="Equals">=</button>
      </div>
      <div class="footer">Keyboard: 0-9 • + − × ÷ • Enter = • Backspace</div>
    </div>

    <script>
      const exprEl = document.getElementById('expr');
      const resEl = document.getElementById('res');
      let expr = '';

      function update() {
        exprEl.textContent = expr;
      }

      function toSymbolsForDisplay(s) {
        return s
          .replace(/\//g, '÷')
          .replace(/\*/g, '×')
          .replace(/-/g, '−');
      }

      function normalizeForEval(s) {
        return s;
      }

      function safeEval(input) {
        // Basic, safe arithmetic evaluator using Function; filters invalid chars
        const allowed = /^[\d+\-*/().\s]*$/;
        if (!allowed.test(input)) throw new Error('Invalid characters');
        // Disallow leading operators except minus and parentheses
        const body = `return (${input})`;
        // eslint-disable-next-line no-new-func
        const fn = new Function(body);
        const out = fn();
        if (typeof out !== 'number' || !Number.isFinite(out)) throw new Error('Invalid result');
        return out;
      }

      function calculate() {
        if (!expr.trim()) return;
        try {
          const normalized = normalizeForEval(expr);
          const value = safeEval(normalized);
          resEl.textContent = String(value);
        } catch (e) {
          resEl.textContent = 'Error';
        }
      }

      function onKey(e) {
        const k = e.key;
        if ((k >= '0' && k <= '9') || k === '.' || k === '(' || k === ')') {
          expr += k;
        } else if (k === '+' || k === '-' || k === '*' || k === '/') {
          expr += k;
        } else if (k === 'Enter' || k === '=') {
          calculate();
        } else if (k === 'Backspace') {
          expr = expr.slice(0, -1);
        } else if (k === 'Escape') {
          expr = '';
          resEl.textContent = '0';
        } else {
          return;
        }
        update();
      }

      function onClick(e) {
        const btn = e.target.closest('button');
        if (!btn) return;
        const val = btn.getAttribute('data-val');
        const act = btn.getAttribute('data-act');
        if (val) {
          expr += val;
          update();
          return;
        }
        if (act === 'clear') {
          expr = '';
          resEl.textContent = '0';
          update();
          return;
        }
        if (act === 'back') {
          expr = expr.slice(0, -1);
          update();
          return;
        }
        if (act === 'equals') {
          calculate();
          return;
        }
      }

      document.addEventListener('keydown', onKey);
      document.querySelector('.keys').addEventListener('click', onClick);
      update();
    </script>
  </body>
  </html>


